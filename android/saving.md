---
icon: database
order: -2
---

# Сохранение сообщений
По сравнению с *Telegraher* или *Ninjagram*, у нас самая **"настоящая"** система сохранения.

Пока они хранят сообщения во *встроенной базе данных Telegram*, возможно, в кэше, мы используем **свою собственную**, работающую на базе Android Room.

У нее есть свои **преимущества**:
-	Вы можете очистить кэш отдельно от удаленных сообщений/истории
-	Сообщения не будут затронуты никакими обновлениями, событиями или действиями Telegram
-	Их можно легко синхронизировать на разных устройствах.

Кроме того, наша система сохранения **автоматически** пробует скачать файлы до того, как они исчезнут на сервере, **что дает больше шансов сохранить медиа**. По умолчанию они хранятся в папке `Download/AyuGram/Saved Attachments`, *но вы можете изменить её в настройках **AyuGram***. Если вы видите их в галерее - создайте файл `.nomedia` в этой папке вручную.

Расположение базы данных - `/data/data/com.radolyn.ayugram/databases/ayu-data*`.

**Но такую систему сложно поддерживать. Серьезно.** Вы можете быть уверены, что сообщения будут в **базе данных AyuGram**, но некоторые из них не будут отображаться из-за их способа загрузки в чатах. Кроме того, при загрузке большой группы удаленных сообщений может произойти **лаг/вылет** на слабом телефоне. Поэтому используйте функцию, **если она вам действительно нужна**.
Вы можете использовать опцию "Просмотреть удаленные", нажав на три точки, чтобы увидеть отдельный чат только с удаленными сообщениями, с возможностью поиска по ним.

!!! Немного технической информации
Когда вы пролистываете чат, Telegram загружает сообщения из вашего кэша группами, по 20-50 сообщений. **AyuGram** подключается к этому процессу и берет идентификаторы последнего и первого сообщений, а между ними загружает удаленные сообщения. Их может быть много - 10, 20, 100, 500, кто знает. Все эти операции выполняются в UI-потоке, что может привести к небольшим лагам. Или взорвет ваш телефон, если сообщений будет больше 1 тыс.

И, как вы понимаете, есть небольшая проблема - удаленные сообщения между группами не загружаются.

==- ГРУППА 1

ID 1

ID 2

...

ID 20
===

**Какое-то удаленное сообщение, которое не будет загружено, например ID 21**

==- ГРУППА 2

ID 22

ID 23

...

===

В ближайшее время эта функция не будет изменена, так как в большинстве случаев она работает хорошо.
!!!

## Сохранение медиа
Буквально. Автоматически пробует загрузить медиафайл после удаления, или создает копию в `Saved Attachments`, если он был загружен ранее.

##Сохранение в диалогах с ботами
Лучше **отключить** эту функцию, так как боты часто редактируют/удаляют сообщения во время своей работы.
